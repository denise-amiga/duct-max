
' 
' tinputconv.bmx (Contains: TInputConv, )
' 
' 

Rem
	bbdoc: The TInputConv type
	about: Interface for converting string identifiers to key/mouse codes
EndRem
Type TInputConv
	
	Rem
		bbdoc: Convert a string into a mouse code
		returns: A mousecode, or -1 if the string is not a valid mouse identifier
	End Rem
	Function StringToMouseCode:Int(miden:String)
		
		Select miden.ToLower()
			Case "mouse1", "rmouse" Return MOUSE_RIGHT
			Case "mouse2", "lmouse" Return MOUSE_LEFT
			Case "mwheel" Return MOUSE_MIDDLE
		End Select
		
		Return - 1
		
	End Function
	
	Rem
		bbdoc: Convert a mouse code to a string
		returns: A string for the given mouse code, or Null if the mouse code was not recognized
	End Rem
	Function MouseCodeToString:String(mousecode:Int)
		
		Select mousecode
			Case MOUSE_RIGHT Return "rmouse"
			Case MOUSE_LEFT Return "lmouse"
			Case MOUSE_MIDDLE Return "mwheel"
		End Select
		
		Return Null
		
	End Function
	
	Rem
		bbdoc: Convert a string into a keycode
		returns: A keycode, or -1 if the string is not a valid key identifier
	End Rem
	Function StringToKeyCode:Int(kiden:String)
		
		Select kiden.ToLower()
			
			'Function keys
			Case "f1" Return KEY_F1
			Case "f2" Return KEY_F2
			Case "f3" Return KEY_F3
			Case "f4" Return KEY_F4
			Case "f5" Return KEY_F5
			Case "f6" Return KEY_F6
			Case "f7" Return KEY_F7
			Case "f8" Return KEY_F8
			Case "f9" Return KEY_F9
			Case "f10" Return KEY_F10
			Case "f11" Return KEY_F11
			Case "f12" Return KEY_F12
			
			'Alphabet keys
			Case "q" Return KEY_Q
			Case "w" Return KEY_W
			Case "e" Return KEY_E
			Case "r" Return KEY_R
			Case "t" Return KEY_T
			Case "y" Return KEY_Y
			Case "u" Return KEY_U
			Case "i" Return KEY_I
			Case "o" Return KEY_O
			Case "p" Return KEY_P
			Case "a" Return KEY_A
			Case "s" Return KEY_S
			Case "d" Return KEY_D
			Case "f" Return KEY_F
			Case "g" Return KEY_G
			Case "h" Return KEY_H
			Case "j" Return KEY_J
			Case "k" Return KEY_K
			Case "l" Return KEY_L
			Case "z" Return KEY_Z
			Case "x" Return KEY_X
			Case "c" Return KEY_C
			Case "v" Return KEY_V
			Case "b" Return KEY_B
			Case "n" Return KEY_N
			Case "m" Return KEY_M
			
			'Numbers and non-alphabet keys
			Case "tilde", "~~" Return KEY_TILDE
			Case "one", "1" Return KEY_1
			Case "two", "2" Return KEY_2
			Case "three", "3" Return KEY_3
			Case "four", "4" Return KEY_4
			Case "five", "5" Return KEY_5
			Case "six", "6" Return KEY_6
			Case "seven", "7" Return KEY_7
			Case "eight", "8" Return KEY_8
			Case "nine", "9" Return KEY_9
			Case "zero", "0" Return KEY_0
			Case "minus", "-", "underscore", "_" Return KEY_MINUS
			Case "plus", "+", "equals", "=" Return KEY_EQUALS
			Case "[", "{" Return KEY_OPENBRACKET
			Case "]", "}" Return KEY_CLOSEBRACKET
			Case ";", ":" Return KEY_SEMICOLON
			Case "quotes", "quote", "'", "~q" Return KEY_QUOTES			'Is 'quotes' even logical?
			Case "period", ".", ">" Return KEY_PERIOD
			Case "comma", ",", "<" Return KEY_COMMA
			Case "backslash", "\", "|" Return KEY_BACKSLASH
			Case "forwardslash", "/", "?" Return KEY_SLASH
			Case "space" Return KEY_SPACE
			Case "print", "printscrn" Return KEY_PRINT
			Case "home" Return KEY_HOME
			Case "end" Return KEY_END
			Case "pagedown", "pgdn" Return KEY_PAGEUP
			Case "pageup", "pgup" Return KEY_PAGEDOWN
			Case "insert" Return KEY_INSERT
			Case "delete", "del" Return KEY_DELETE
			Case "pause" Return 19									'KEY_PAUSE (why is this commented out, from brl.keycodes?)
			Case "scrlock", "scrllock", "scrolllock" Return 145		'KEY_SCROLL (sigh..)
			
			'Num keys
			Case "numlock" Return 144								'KEY_NUMLOCK (....)
			Case "num0" Return KEY_NUM0
			Case "num1" Return KEY_NUM1
			Case "num2" Return KEY_NUM2
			Case "num3" Return KEY_NUM3
			Case "num4" Return KEY_NUM4
			Case "num5" Return KEY_NUM5
			Case "num6" Return KEY_NUM6
			Case "num7" Return KEY_NUM7
			Case "num8" Return KEY_NUM8
			Case "num9" Return KEY_NUM9
			Case "num*", "nummultiply", "numasterisk" Return KEY_NUMMULTIPLY
			Case "num/", "numdivide", "numslash" Return KEY_NUMDIVIDE
			Case "num+", "numadd", "numplus" Return KEY_NUMADD
			Case "num-", "numsubtract", "numminus" Return KEY_NUMSUBTRACT
			Case "num.", "numdel", "numdecimal" Return KEY_NUMDECIMAL
			'Case "numreturn" return key_num
			
			'Arrow keys
			Case "up" Return KEY_UP
			Case "down" Return KEY_DOWN
			Case "left" Return KEY_LEFT
			Case "right" Return KEY_RIGHT
			
			'Modifiers
			Case "backspace" Return KEY_BACKSPACE
			Case "tab" Return KEY_TAB
			Case "capslock", "caps" Return 20 'KEY_CAPSLOCK (again, why is this commented out?)
			Case "control", "ctrl" Return MODIFIER_CONTROL
			Case "lcontrol", "lctrl" Return KEY_LCONTROL
			Case "rcontrol", "rctrl" Return KEY_RCONTROL
			Case "shift" Return MODIFIER_SHIFT
			Case "lshift" Return KEY_LSHIFT
			Case "rshift" Return KEY_RSHIFT
			Case "alt" Return MODIFIER_ALT
			Case "lalt" Return KEY_LALT
			Case "ralt" Return KEY_RALT
			
			'Other
			Case "escape", "esc" Return KEY_ESCAPE
			
		End Select
		
		Return - 1
		
	End Function
	
	Rem
		bbdoc: Convert a keycode to a string
		returns: A string for the given keycode, or Null if the keycode was not recognized
		about: 
	EndRem
	Function KeyCodeToString:String(keycode:Int)
		
		Select keycode
			
			'Function keys
			Case KEY_F1 Return "F1"
			Case KEY_F2 Return "F2"
			Case KEY_F3 Return "F3"
			Case KEY_F4 Return "F4"
			Case KEY_F5 Return "F5"
			Case KEY_F6 Return "F6"
			Case KEY_F7 Return "F7"
			Case KEY_F8 Return "F8"
			Case KEY_F9 Return "F9"
			Case KEY_F10 Return "F10"
			Case KEY_F11 Return "F11"
			Case KEY_F12 Return "F12"
			
			'Alphabet keys
			Case KEY_Q Return "Q"
			Case KEY_W Return "W"
			Case KEY_E Return "E"
			Case KEY_R Return "R"
			Case KEY_T Return "T"
			Case KEY_Y Return "Y"
			Case KEY_U Return "U"
			Case KEY_I Return "I"
			Case KEY_O Return "O"
			Case KEY_P Return "P"
			Case KEY_A Return "A"
			Case KEY_S Return "S"
			Case KEY_D Return "D"
			Case KEY_F Return "F"
			Case KEY_G Return "G"
			Case KEY_H Return "H"
			Case KEY_J Return "J"
			Case KEY_K Return "K"
			Case KEY_L Return "L"
			Case KEY_Z Return "Z"
			Case KEY_X Return "X"
			Case KEY_C Return "C"
			Case KEY_V Return "V"
			Case KEY_B Return "B"
			Case KEY_N Return "N"
			Case KEY_M Return "M"
			
			'Numbers and non-alphabet keys
			Case KEY_TILDE Return "TILDE"
			Case KEY_1 Return "ONE"
			Case KEY_2 Return "TWO"
			Case KEY_3 Return "THREE"
			Case KEY_4 Return "FOUR"
			Case KEY_5 Return "FIVE"
			Case KEY_6 Return "SIX"
			Case KEY_7 Return "SEVEN"
			Case KEY_8 Return "EIGHT"
			Case KEY_9 Return "NINE"
			Case KEY_0 Return "ZERO"
			Case KEY_MINUS Return "MINUS"
			Case KEY_EQUALS Return "EQUALS"
			Case KEY_OPENBRACKET Return "["
			Case KEY_CLOSEBRACKET Return "]"
			Case KEY_SEMICOLON Return ";"
			Case KEY_QUOTES Return "~q"
			Case KEY_PERIOD Return "PERIOD"
			Case KEY_COMMA Return "COMMA"
			Case KEY_BACKSLASH Return "BACKSLASH"
			Case KEY_SLASH Return "FORWARDSLASH"
			Case KEY_SPACE Return "SPACE"
			Case KEY_PRINT Return "PRINTSCRN"
			Case KEY_HOME Return "HOME"
			Case KEY_END Return "END"
			Case KEY_PAGEUP Return "PGDN"
			Case KEY_PAGEDOWN Return "PGUP"
			Case KEY_INSERT Return "INSERT"
			Case KEY_DELETE Return "DELETE"
			Case 19 Return "PAUSE"
			Case 145 Return "SCRLLOCK"
			
			'Num keys
			Case 144 Return "NUMLOCK"
			Case KEY_NUM0 Return "NUM0"
			Case KEY_NUM1 Return "NUM1"
			Case KEY_NUM2 Return "NUM2"
			Case KEY_NUM3 Return "NUM3"
			Case KEY_NUM4 Return "NUM4"
			Case KEY_NUM5 Return "NUM5"
			Case KEY_NUM6 Return "NUM6"
			Case KEY_NUM7 Return "NUM7"
			Case KEY_NUM8 Return "NUM8"
			Case KEY_NUM9 Return "NUM9"
			Case KEY_NUMMULTIPLY Return "NUM*"
			Case KEY_NUMDIVIDE Return "NUM/"
			Case KEY_NUMADD Return "NUM+"
			Case KEY_NUMSUBTRACT Return "NUM-"
			Case KEY_NUMDECIMAL Return "NUM."
			'Case "numreturn" return key_num
			
			'Arrow keys
			Case KEY_UP Return "UP"
			Case KEY_DOWN Return "DOWN"
			Case KEY_LEFT Return "LEFT"
			Case KEY_RIGHT Return "RIGHT"
			
			'Modifiers
			Case KEY_BACKSPACE Return "BACKSPACE"
			Case KEY_TAB Return "TAB"
			Case 20 Return "CAPSLOCK"
			Case MODIFIER_CONTROL Return "CTRL"
			Case KEY_LCONTROL Return "LCTRL"
			Case KEY_RCONTROL Return "RCTRL"
			Case MODIFIER_SHIFT Return "SHIFT"
			Case KEY_LSHIFT Return "LSHIFT"
			Case KEY_RSHIFT Return "RSHIFT"
			Case MODIFIER_ALT Return "ALT"
			Case KEY_LALT Return "LALT"
			Case KEY_RALT Return "RALT"
			
			'Other
			Case KEY_ESCAPE Return "ESCAPE"
			
		End Select
		
		Return Null
		
	End Function
	
End Type

























